<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title></title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css"
    >
    <style></style>
  </head>

  <body>
    <main>
      <h1>Duck Duck Go Search Allowlist</h1>
      <section>
      <label>Sites (whitespace separated)<textarea id=sites rows=16>mayoclinic.org
clevelandclinic.org</textarea></label>
      <label>Query<input id=query value=fever></input></label>
      <a href="#" id=search_link role=button>Search</a>
      </section>
      <section>
      <label>Smart bookmark URL<input id=bookmark readonly></input></label>
      </section>
    </main>
    <script>
    const update = () => {
      sites_list = sites.value.split(/[\n\t ]+/)
      sites_list = sites_list.filter(str => str.trim())
      sites_list = sites_list.map(s => `site:${s}`)
      sites_exp = `( ${sites_list.join(' || ')} )`
      base_url = encodeURI(`https://duckduckgo.com/?q=${sites_exp}`)
      bookmark.value = base_url + '+%s'
      search_link.href = base_url + '+' + encodeURIComponent(query.value)
    }
    
    sites.addEventListener('input', update)
    query.addEventListener('input', update)
    update()
    </script>
  </body>
</html>
